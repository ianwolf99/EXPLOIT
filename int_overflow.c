#include "stdio.h"
#include "stdlib.h"

buf = malloc(sizeof(something) *user_controlled);
for (int i = 0; i < user_controlled; ++i)
{
	/* code */
	if(user_buf[i] == 0)
		break;
	copyinto(buf,user_buf )
}